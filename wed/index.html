<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interrupt C++ Code</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts (Roboto) and Material Symbols -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />
    <style>
        body {
            font-family: 'Roboto', sans-serif;
        }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            font-size: 20px; /* Consistent icon size */
        }
        /* Simple toast notification style */
        #toast {
            visibility: hidden;
            min-width: 150px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 8px;
            padding: 12px;
            position: fixed;
            z-index: 10;
            left: 50%;
            bottom: 30px;
            transform: translateX(-50%);
            opacity: 0;
            transition: visibility 0s 0.5s, opacity 0.5s linear;
        }
        #toast.show {
            visibility: visible;
            opacity: 1;
            transition: opacity 0.5s linear;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white rounded-2xl shadow-xl w-full max-w-2xl overflow-hidden">
        <!-- Header -->
        <div class="p-5 border-b border-gray-200">
            <h1 class="text-xl font-medium text-gray-800">Interrupt C++ Code</h1>
            <p class="text-gray-600 text-sm mt-1">File: interrupt.cpp</p>
        </div>

        <!-- Code Block -->
        <div class="p-5 bg-gray-50">
            <pre class="bg-gray-900 text-white text-sm p-4 rounded-lg overflow-x-auto"><code id="code-block">#include &lt;stdio.h&gt;
#include &lt;wiringPi.h&gt;

#define BUTTONPIN 1

volatile int counter = 0;

void myinterrupt(void) {
    counter++;
    printf("counter = %d\n", counter);
}

int main(void) {
    wiringPiSetup();
    pinMode(BUTTONPIN, INPUT);
    wiringPiISR(BUTTONPIN, INT_EDGE_RISING, &myinterrupt);
    while(1);
    return 0;
}
</code></pre>
        </div>

        <!-- NEW SECTION: Compile Command -->
        <div class="p-5 border-t border-gray-200">
            <h2 class="text-lg font-medium text-gray-800 mb-3">Compile Command</h2>
            <pre class="bg-gray-200 text-gray-800 text-sm p-3 rounded-lg overflow-x-auto"><code>g++ -o interrupt interrupt.cpp -lwiringPi</code></pre>
        </div>


        <!-- Actions -->
        <div class="p-5 flex flex-col sm:flex-row gap-3 border-t border-gray-200">
            <button id="copy-btn" class="flex-1 inline-flex items-center justify-center gap-2 px-4 py-3 bg-indigo-600 text-white text-sm font-medium rounded-full shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition duration-150 ease-in-out">
                <span class="material-symbols-outlined">content_copy</span>
                Copy Code
            </button>
            <button id="download-btn" class="flex-1 inline-flex items-center justify-center gap-2 px-4 py-3 bg-gray-200 text-gray-800 text-sm font-medium rounded-full hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition duration-150 ease-in-out">
                <span class="material-symbols-outlined">download</span>
                Download .cpp
            </button>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast">Copied to clipboard!</div>

    <!-- JavaScript -->
    <script>
        // Get elements
        const copyButton = document.getElementById('copy-btn');
        const downloadButton = document.getElementById('download-btn');
        const codeBlock = document.getElementById('code-block');
        const toast = document.getElementById('toast');

        // --- Copy Function ---
        copyButton.addEventListener('click', () => {
            // We use the 'innerText' of the code block to get the un-escaped text
            const codeText = codeBlock.innerText;

            // Create a temporary textarea to hold the text
            const textArea = document.createElement('textarea');
            textArea.value = codeText;
            document.body.appendChild(textArea);
            
            // Select and copy
            textArea.select();
            try {
                // Use execCommand for broad compatibility, as requested
                document.execCommand('copy');
                showToast('Copied to clipboard!');
            } catch (err) {
                console.error('Failed to copy text: ', err);
                showToast('Failed to copy!');
            }
            
            // Clean up
            document.body.removeChild(textArea);
        });

        // --- Download Function ---
        downloadButton.addEventListener('click', () => {
            const codeText = codeBlock.innerText;
            const filename = 'interrupt.cpp'; // Updated filename

            // Create a Blob with the correct MIME type and charset
            // This is critical for preventing format issues
            const blob = new Blob([codeText], { type: 'text/plain;charset=utf-8' });

            // Create a temporary link to trigger the download
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.href = url;
            link.download = filename;
            
            // Append to body, click, and remove
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Clean up the object URL
            URL.revokeObjectURL(url);
        });

        // --- Toast Function ---
        function showToast(message) {
            toast.innerText = message;
            toast.className = 'show';
            setTimeout(() => {
                toast.className = toast.className.replace('show', '');
            }, 2000); // Show for 2 seconds
        }

    </script>

</body>
</html>


